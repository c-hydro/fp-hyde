Annex B - Rainfarm
==================

Rainfarm belongs to the family of metagaussian models and it is based on a nonlinear transformation of a linearly correlated process. This approach is closely related to the Turning Bands Method and has been used both for satellite-based rainfall measurement validation and for stochastic rainfall modelling.

The model is able to generate small-scale rainfall fields that take into account not only the total amount of precipitation predicted by the meteorological model but also its linear correlation structure and the position of the main rainfall patterns. Due to the straightforward link between the model parameters and the large-scale field, this model is suitable for operational downscaling procedures.

.. figure:: img/hyde_rfarm/rfarm_example_horizontal.png
    :height: 500px
    :width: 1000px
    :scale: 50 %
    :alt: example of Rainfarm application.
    :align: center

    Time average of the original, LAM field panel (a) and of one realization of the stochastic field generated by the Rainfarm panel (b). The values indicate the average precipitation in mm/h.


Rainfarm uses the spectral information of large-scale meteorological predictions and generates fine resolution precipitation fields by propagating this information to smaller scales. The basic idea is to reconstruct the Fourier spectrum of the small-scale precipitation field by preserving the LAM information at the scales where we are confident in the meteorological prediction. The rainfall field is seen as the superposition of a finite number of harmonics with amplitudes decreasing as spatial and temporal scales become smaller. For a given realization (the predicted field at hand) the harmonics at large scales are assumed to be well predicted by the meteorological model, and should be preserved. A major concern is to figure out which are the scales below which the forecasted fields are considered to be unreliable.

.. table:: Summary of the model Rainfarm parameters.
    :widths: auto

    +-----------+--------------------------------+
    | Parameter |           Description          |
    +-----------+--------------------------------+
    |:math:`L_0`| Reliable spatial scale of LAM  |
    +-----------+--------------------------------+
    |:math:`T_0`| Reliable temporal scale of LAM |
    +-----------+--------------------------------+
















    